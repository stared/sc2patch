# StarCraft II Patch Visualization

Interactive visualization of StarCraft II balance patch history using React, D3.js, and TypeScript.

## Features

- **Interactive grid view**: All patches with affected units/buildings
- **Click to filter**: Select any unit to see its balance history
- **Animated transitions**: Smooth D3 transitions when filtering
- **Color-coded changes**: Buffs (blue), nerfs (red), mixed (orange)
- **Tooltips**: Hover to see detailed changes
- **Tech tree icons**: 203 unit/building/upgrade images from Liquipedia

## Quick Start

```bash
# Install dependencies
pnpm install

# Development server
pnpm dev          # Visit http://localhost:5173

# Production build
pnpm build        # Includes TypeScript type checking

# Linting
pnpm lint
```

## Architecture

### Core Files

- **App.tsx**: Main application - handles data loading, URL state, rendering coordination, and UI
- **utils/patchGridRenderer.ts**: D3 rendering class with organized methods (render, calculateLayout, renderPatchLabel, renderEntities, renderChanges)
- **utils/uxSettings.ts**: Centralized UX config (colors, timing, layout constants)
- **utils/dataLoader.ts**: Data fetching and processing
- **types.ts**: TypeScript type definitions

### Data Format

The visualization reads from `public/data/`:

- `processed/patches/*.json` - Individual patch files
- `patches_manifest.json` - Index of all patches
- `units.json` - Unit metadata (names, types)

Data is generated by the Python pipeline (see main README).

### Styling

- Dark theme (`#0a0a0a` background)
- Race colors: Terran (blue), Zerg (purple), Protoss (gold)
- Tech tree icon styling with transparency

## Animation System

See `timing` config in `utils/uxSettings.ts`:

**Timing values:**
- `fade: 600ms` - All fade transitions
- `move: 800ms` - All movement transitions

**Selection (grid → filtered):**
1. Fade out irrelevant entities (600ms)
2. Move selected unit to filtered position (800ms)
3. Show change notes (fade in after 1400ms delay = fade + move)

**Deselection (filtered → grid):**
1. Selected unit moves back (800ms)
2. Previously visible patches move to new positions (800ms)
3. Newly appearing patches/units fade in at final position (no movement)

## Tech Stack

- **React 19** with TypeScript
- **D3 modules**: d3-selection, d3-transition, d3-ease (targeted imports, not full d3 package)
- **Vite** for build tooling
- **pnpm** for package management
- **ESLint** with strict TypeScript rules

## Assets

Unit and building images are located in `public/assets/units/`:
- 191 tech tree icons (50×50 for units, 76×76 for buildings)
- Source: Liquipedia tech tree
- See `public/assets/units/README.md` for details

## Development

### Adding New Features

1. Update types in `src/types.ts`
2. Modify rendering logic in `utils/patchGridRenderer.ts`
3. Update UX constants in `utils/uxSettings.ts` if needed
4. Run build (includes type checking): `pnpm build`
5. Run linting: `pnpm lint`

### Debugging

- Use React DevTools for component inspection
- D3 selections are logged to console in development
- Check `public/data/` for data issues

## Deployment

The visualization is deployed to GitHub Pages:

```bash
pnpm build          # Creates dist/ with BASE_URL=/sc2patch/
# Push to GitHub, Actions will deploy
```

**Important**: Update `vite.config.ts` base URL if deploying elsewhere.

## Known Issues

- Some older patches may have incomplete data
- Ramp range changes are split by race (should be neutral)
- Missing images fall back to placeholder (gray question mark)

## License

MIT
